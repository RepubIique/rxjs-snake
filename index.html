<!doctype html>
<html>
<head>
    <title>Snake!</title>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"/>
    <link rel="stylesheet" href="/src/styles/gameStyle.css">
    
</head>
<body>
    
    <ion-app>
        <ion-header>
          <ion-toolbar color="primary">
              <ion-row>
                  <ion-col>
                      <img src="/logo.png" class="logo"/>
                      <ion-title ><ion-text color="light">MY SNAKE</ion-text></ion-title>
                     </ion-col>
                  <ion-col>
                      <ion-button id="start" color="warning">
                          <ion-text color="light">Play</ion-text>
                        </ion-button>
                    </ion-col>
              </ion-row> 
          </ion-toolbar>
        </ion-header>
        
      
        <ion-content class="ion-padding">
            
            <ion-grid>
                <ion-row>
                  <ion-col size="12" size-sm>
                    <div>
                        <ion-card
                        style="width: -webkit-fill-available;"
                        >
                            <ion-card-content>
                                <svg id="board" ></svg>
                            </ion-card-content>
                        </ion-card>
                        
                    </div>
                  </ion-col>
                  <ion-col size="12" size-sm>
                    <div>
                        <ion-row>
                            <ion-card 
                            style="width: -webkit-fill-available;"
                            >
                                <ion-card-header>
                                    <ion-card-title>
                                       Top 5 Highscore
                                    </ion-card-title>
                                </ion-card-header>
                                <ion-card-content id="scorelist">
                                    
                                </ion-card-content>
                            </ion-card>
                        </ion-row>
                        <ion-row>
                            <ion-card 
                            style="width: -webkit-fill-available;"
                            >
                                <ion-card-header>
                                    <ion-card-title>
                                        Game Settings
                                    </ion-card-title>
                                </ion-card-header>
                                <ion-card-content>
                                    <ion-item>
                                        <ion-range min="1000" max="2000" step="100" snaps="true" ticks="false" color="secondary">
                                            <ion-icon slot="start" size="small" color="danger" name="thermometer"></ion-icon>
                                            <ion-icon slot="end" color="danger" name="thermometer"></ion-icon>
                                        </ion-range>
                                      </ion-item>
                                </ion-card-content>
                            </ion-card>
                        </ion-row>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
              <ion-fab vertical="bottom" horizontal="end" slot="fixed">
                <ion-fab-button>
                  <ion-icon name="arrow-forward-circle"></ion-icon>
                </ion-fab-button>
              </ion-fab>

             <div id="id01" class="modal">
               <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">Ã—</span>
               <form class="modal-content" action="/action_page.php">
                 <div class="container">
                    
                   <h1>Game Over</h1>
                   <p>Score : 30</p>
                   <p>Enter your name and save to record score</p>
                   <input type="text" name="username" id="username" placeholder="Your name">
                   
                   <div class="clearfix">
                    <button type="submit" class="savebtn" id="saveScoreBtn" onclick="saveHighScore(event)" disabled>Save</button>
                     <button type="button" onclick="document.getElementById('id01').style.display='none'" class="deletebtn">Cancel</button>
                   </div>
                 </div>
               </form>
             </div>
        </ion-content>
       
        
        
        <ion-footer>
          <ion-toolbar>
              <ion-row>
                  <ion-col>
                    <ion-title id="score">Current Score: 0</ion-title>
                  </ion-col>
                  <ion-col>
                    <div id="highscore"></div>
                  </ion-col>
              </ion-row>
          </ion-toolbar>
        </ion-footer>
      </ion-app>


   
    
    <script src="dist/bundle.js"></script>
    <!-- <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@4.7.4/dist/ionicons/ionicons.esm.js"></script> -->
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@4.7.4/dist/ionicons/ionicons.js"></script>
    <script>
        const username = document.getElementById('username')
        const saveScoreBtn = document.getElementById('saveScoreBtn')
        const mostRecentScore = localStorage.getItem('mostRecentScore')
        const highscore = JSON.parse(localStorage.getItem('highscore')) || [];
        const MAX_HIGH_SCORES = 5;
        
        username.addEventListener('keyup', () => {
            saveScoreBtn.disabled = !username.value
        })
       saveHighScore = (e) =>{
        console.log("clicked")
        console.log(mostRecentScore)
        e.preventDefault();
        const score = {
            score:mostRecentScore,
            name:username.value
        };
        highscore.push(score)
        highscore.sort((a,b)=> b.score - a.score)
        highscore.splice(5)

        localStorage.setItem('highscore', JSON.stringify(highscore))
        document.getElementById('id01').style.display='none'
        
        console.log(highscore)
}      
    </script>
    
</body>
</html>

